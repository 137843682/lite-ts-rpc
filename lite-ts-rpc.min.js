!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,(()=>(()=>{"use strict";var e=[,(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0,function(e){e.authData="H-A-D",e.authToken="H-A-T",e.env="H-E",e.timeout="H-T"}(t.Header||(t.Header={}))},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HttpMethod=void 0,function(e){e.get="GET",e.post="POST"}(t.HttpMethod||(t.HttpMethod={}))},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LoadRpcClientEnumHandler=void 0;const o=n(4);class a extends o.LoadEnumHandlerBase{constructor(e,t,n){super(),this.m_Rpc=e,this.m_DefaultApp=t,this.m_EnumNameApp=Object.entries(n).reduce(((e,[t,n])=>{for(const r of n)e[r]=t;return e}),{})}handle(e){var t;return r(this,void 0,void 0,(function*(){const n=yield this.m_Rpc.call({body:{areaNo:e.areaNo,name:e.enum.name},route:`/${null!==(t=this.m_EnumNameApp[e.enum.name])&&void 0!==t?t:this.m_DefaultApp}/find-enum-items`});e.res=n.reduce(((e,t)=>(e[t.value]=t,e)),{})}))}}t.LoadRpcClientEnumHandler=a},function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(5),t),o(n(6),t),o(n(7),t),o(n(8),t),o(n(9),t),o(n(10),t),o(n(11),t)},function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Enum=void 0;t.Enum=class{get allItem(){var e;return null!==(e=this.m_AllItem)&&void 0!==e||(this.m_AllItem=new Promise(((e,t)=>n(this,void 0,void 0,(function*(){try{const t={areaNo:this.m_AreaNo,enum:this,res:{}};yield this.m_LoadHandler.handle(t),e(t.res)}catch(e){t(e)}}))))),this.m_AllItem}get items(){return new Promise(((e,t)=>n(this,void 0,void 0,(function*(){try{const t=yield this.allItem;e(Object.values(t))}catch(e){t(e)}}))))}constructor(e,t,n,r){this.name=e,this.m_AreaNo=t,this.m_LoadHandler=n,this.m_ReduceFunc=r}get(e){return n(this,void 0,void 0,(function*(){return(yield this.items).find((t=>e(t)))}))}getReduce(e){var t;return n(this,void 0,void 0,(function*(){null!==(t=this.m_Reduce)&&void 0!==t||(this.m_Reduce=new Promise(((e,t)=>n(this,void 0,void 0,(function*(){try{const t=yield this.items;e(Object.entries(this.m_ReduceFunc).reduce(((e,[n,r])=>(e[n]=t.reduce(((e,t)=>r(e,t)),{}),e)),{}))}catch(e){return t(e)}})))));return(yield this.m_Reduce)[e]}))}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EnumFactory=void 0;const r=n(5),o=n(7);class a extends o.EnumFactoryBase{constructor(e,t){super(),this.m_LoadHandler=e,this.m_ReduceFunc=t}build(e,t=0){return new r.Enum("string"==typeof e?e:e.name,t,this.m_LoadHandler,this.m_ReduceFunc)}}t.EnumFactory=a},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EnumFactoryBase=void 0;class n{}t.EnumFactoryBase=n,n.ctor="EnumFactoryBase"},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EnumItem=void 0;t.EnumItem=class{}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LoadEnumHandlerBase=void 0;t.LoadEnumHandlerBase=class{setNext(e){return this.next=e,this.next}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ValueTypeData=void 0;const r=n(8);class o extends r.EnumItem{}t.ValueTypeData=o},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LoadRpcServerEnumHandler=t.AreaData=void 0;const o=n(4),a=n(13);class i extends o.EnumItem{}t.AreaData=i;class c extends o.LoadEnumHandlerBase{get allArea(){var e;return null!==(e=this.m_AllArea)&&void 0!==e||(this.m_AllArea=new Promise(((e,t)=>r(this,void 0,void 0,(function*(){try{const t=yield this.getAllEnumItem(this.m_Rpc,c.defaultApp,{name:i.name});e(t)}catch(e){t(e)}}))))),this.m_AllArea}constructor(e,t,n){super(),this.m_Rpc=e,this.m_BuildRpcFunc=t,this.m_LoadBalanceRpc={},this.m_EnumNameApp=Object.entries(n).reduce(((e,[t,n])=>{for(const r of n)e[r]=t;return e}),{})}handle(e){var t;return r(this,void 0,void 0,(function*(){if(null!==(t=e.areaNo)&&void 0!==t||(e.areaNo=0),e.enum.name==i.name)e.res=yield this.allArea;else{const t=this.m_EnumNameApp[e.enum.name];if(!t)return this.next.handle(e);if(!this.m_LoadBalanceRpc[e.areaNo]){const t=yield this.allArea;if(!t[e.areaNo])throw new a.CustomError(a.ErrorCode.panic,`${this.constructor.name}: 缺少${i.name}.value = ${e.areaNo}`);this.m_LoadBalanceRpc[e.areaNo]=Object.entries(t[e.areaNo].loadBalance).reduce(((e,[t,n])=>(e[t]=this.m_BuildRpcFunc(n),e)),{})}const n=this.m_LoadBalanceRpc[e.areaNo][t];if(!n)throw new a.CustomError(a.ErrorCode.panic,`${this.constructor.name}: 缺少${i.name}.loadBalance[${t}]`);e.res=yield this.getAllEnumItem(n,t,{areaNo:e.areaNo,name:e.enum.name})}}))}getAllEnumItem(e,t,n){return r(this,void 0,void 0,(function*(){return(yield e.call({body:n,route:`/${t}/find-enum-items`})).reduce(((e,t)=>(e[t.value]=t,e)),{})}))}}t.LoadRpcServerEnumHandler=c,c.defaultApp="config"},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CustomError=t.ErrorCode=void 0;const r=n(14);Object.defineProperty(t,"ErrorCode",{enumerable:!0,get:function(){return r.ErrorCode}});const o=n(15);Object.defineProperty(t,"CustomError",{enumerable:!0,get:function(){return o.CustomError}}),globalThis["lite-ts-error"]={CustomError:o.CustomError,ErrorCode:r.ErrorCode}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCode=void 0,function(e){e[e.tip=1]="tip",e[e.warning=2]="warning",e[e.api=501]="api",e[e.auth=502]="auth",e[e.verify=503]="verify",e[e.timeout=504]="timeout",e[e.valueTypeNotEnough=505]="valueTypeNotEnough",e[e.redirect=506]="redirect",e[e.waitLock=507]="waitLock",e[e.panic=599]="panic"}(t.ErrorCode||(t.ErrorCode={}))},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CustomError=void 0;class n extends Error{constructor(e,t){super(""),this.code=e,this.data=t}}t.CustomError=n},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MockRpc=void 0;const o=n(17);class a extends o.RpcBase{constructor(e){super(),this.m_Rpc=e}callWithoutThrow(e){var t;return r(this,void 0,void 0,(function*(){const n=(null!==(t=a.stub[e.route])&&void 0!==t?t:[]).find((t=>t.predicate(e)));return n?n.data:this.m_Rpc.callWithoutThrow(e)}))}}t.MockRpc=a},function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RpcBase=void 0;class r{call(e){return n(this,void 0,void 0,(function*(){const t=yield this.callWithoutThrow(e);if(t.err)throw r.buildErrorFunc(t.err,t.data);return t.data}))}}t.RpcBase=r,r.ctor="RpcBase"}],t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}var r={};return(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.RpcBase=e.MockRpc=e.LoadRpcServerEnumHandler=e.LoadRpcClientEnumHandler=e.HttpMethod=e.Header=e.AreaData=void 0;const t=n(1);Object.defineProperty(e,"Header",{enumerable:!0,get:function(){return t.Header}});const o=n(2);Object.defineProperty(e,"HttpMethod",{enumerable:!0,get:function(){return o.HttpMethod}});const a=n(3);Object.defineProperty(e,"LoadRpcClientEnumHandler",{enumerable:!0,get:function(){return a.LoadRpcClientEnumHandler}});const i=n(12);Object.defineProperty(e,"AreaData",{enumerable:!0,get:function(){return i.AreaData}}),Object.defineProperty(e,"LoadRpcServerEnumHandler",{enumerable:!0,get:function(){return i.LoadRpcServerEnumHandler}});const c=n(16);Object.defineProperty(e,"MockRpc",{enumerable:!0,get:function(){return c.MockRpc}});const u=n(17);Object.defineProperty(e,"RpcBase",{enumerable:!0,get:function(){return u.RpcBase}}),globalThis["lite-ts-rpc"]={AreaData:i.AreaData,Header:t.Header,HttpMethod:o.HttpMethod,LoadRpcClientEnumHandler:a.LoadRpcClientEnumHandler,LoadRpcServerEnumHandler:i.LoadRpcServerEnumHandler,MockRpc:c.MockRpc,RpcBase:u.RpcBase}})(),r})()));